---
import dayjs from 'dayjs'
import 'dayjs/locale/th'
import Layout from '../layouts/Layout.astro'
import SectionHeader from '../components/SectionHeader.astro'
import SectionMainContent from '../components/SectionMainContent.astro'
import SectionWorkExperience from '../components/SectionWorkExperience.astro'
import SectionFooter from '../components/SectionFooter.astro'
import GoogleAd from '../components/GoogleAd.astro'

import { getLangFromUrl } from '../i18n/utils'

interface Props {
  resume: any
  experience?: any
}

// Import data
import expData from '../i18n/experience.json'
import resumeData from '../i18n/resume.en.json'

// Setup locale and data
const langName = getLangFromUrl(Astro.url)
const { experience = expData, resume = resumeData } = Astro.props

dayjs.locale(langName)
---

<Layout
  title={`${resume.fullname} - ${resume.job} | Portfolio & Resume`}
  description={resume.detail.substring(0, 180) + (resume.detail.length > 180 ? '...' : '')}
  image=""
>
  <div class="pt-5">
    <SectionHeader resume={resume} experience={experience} />
    <SectionMainContent resume={resume} experience={experience} />
    {
      import.meta.env.PUBLIC_ADSENSE_HOME_SLOT && (
        <div class="container my-4 d-print-none">
          <GoogleAd slot={import.meta.env.PUBLIC_ADSENSE_HOME_SLOT} />
        </div>
      )
    }
    <p class="pagebreak"></p>
    <SectionWorkExperience workExperience={resume.work} />
    <SectionFooter />
  </div>
</Layout>
<style is:global>
  :root {
    --tooltip-color: #dc3545;
  }

  /* Layout and Typography */
  #__layout .section-title {
    min-height: 65px;
    margin-right: 30px;
    text-align: right;
  }

  #__layout .section-title h2 {
    min-width: 175px;
    font-size: 1.2rem;
    line-height: 0;
    margin-bottom: 0 !important;
    margin-top: 0.9em;
    color: #bbbbbb;
    text-transform: uppercase;
  }

  #__layout .section-title small {
    color: var(--text-muted);
    font-size: 0.65rem;
  }

  #__layout .profile-img img {
    object-position: top;
    object-fit: contain;
    max-height: 380px;
    width: 100%;
  }

  /* Grid Layouts */
  #__layout .section-contact .contact-item {
    grid-template-columns: repeat(2, 1fr);
  }

  .section-coding .stats {
    grid-template-columns: repeat(4, 1fr);
    grid-column-gap: 0.2em;
    grid-row-gap: 1em;
  }

  /* Tooltip Components */
  .tippy-tooltip.dark-theme {
    background-color: var(--tooltip-color) !important;
  }

  .tippy-roundarrow {
    fill: var(--tooltip-color) !important;
  }

  /* Links and Text Styles */
  #__layout address a {
    fill: var(--text-secondary);
  }

  .stats-item .name {
    color: var(--text-secondary);
    font-size: 0.75rem;
    text-transform: uppercase;
    line-height: 1;
  }

  .stats-item .value {
    color: var(--text-secondary-value);
    font-size: 1.15rem;
    font-weight: 500;
  }

  /* Mobile responsive styles */
  @media (max-width: 36rem) {
    #__layout .header {
      padding: 2em 0 0 0;
    }

    #__layout .header .name-wrapper {
      margin-bottom: 0em;
    }

    #__layout .header .profile-img {
      margin-bottom: 5em;
      height: 420px;
    }

    #__layout .header .profile-img img {
      position: absolute;
      object-position: top;
      object-fit: cover;
      max-height: 460px;
      width: 100%;
      top: 5px;
      left: 0;
    }

    #__layout .header .section-wrapper.grid-personal {
      grid-template-columns: repeat(1, 1fr) !important;
    }

    #__layout .section-title {
      padding-top: 1em;
      text-align: left;
    }

    #__layout .section-title h2 {
      font-size: 1.4rem;
    }
  }

  /* Tablet and larger screens */
  @media (min-width: 896px) {
    #__layout .section-contact .contact-item {
      grid-template-columns: repeat(4, 1fr);
    }
  }

  /* Coding stats mobile layout */
  @media (max-width: 896px) {
    #__layout .section-coding .stats {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  /* Print styles */
  @media print {
    #__layout address a {
      fill: var(--text-secondary);
      font-weight: bold;
      text-decoration: none !important;
    }

    #__layout .section-contact .contact-item {
      grid-template-columns: repeat(3, 1fr) !important;
      gap: 1em;
    }
  }

  /* Header Styles */
  .header .name-wrapper {
    margin: 1em 0 2em 0;
  }

  .header .name-wrapper > .name {
    display: flex;
    justify-items: flex-start;
    align-items: center;
    gap: 0.5em;
  }

  .header .name-wrapper > .name > h1 {
    text-transform: uppercase;
    color: var(--text-primary);
    line-height: 2rem;
    margin: -0.12em 0 0.2em;
  }

  .header .name-wrapper > .name ul {
    margin-top: -0.6em;
  }

  .header .name-wrapper > span {
    font-size: 1.5rem;
    color: var(--text-color-link);
  }

  .header .name-wrapper > span.th-name {
    font-size: 2rem;
  }

  /* Button and Link Styles */
  .header .name-wrapper > .name a,
  .header .social-icon > li > a {
    display: block;
    font-size: 0.85rem;
    color: var(--menu-color);
    text-align: center;
    border-radius: 2px;
    border: 2px solid var(--menu-border-color);
    font-weight: bold;
  }

  .header .name-wrapper > .name a:hover,
  .header .social-icon > li > a:hover {
    border-color: var(--menu-border-color-hover);
  }

  .header .name-wrapper > .name a {
    width: 36px;
    height: 36px;
    line-height: 2.2rem;
  }

  .header .social-icon > li > a {
    line-height: 2.1rem;
    padding: 0 0.75em;
  }

  /* Grid Personal Section */
  .header .grid-personal {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    grid-column-gap: 0.2em;
    grid-row-gap: 0.2em;
  }

  .header .grid-personal .personal {
    margin: 10px 0;
  }

  .header .grid-personal .personal strong {
    text-transform: uppercase;
    font-size: 0.9rem;
    font-weight: bold;
    color: var(--text-secondary-value);
    display: block;
    line-height: 1;
  }

  .header .grid-personal .personal small {
    text-transform: uppercase;
    font-weight: normal;
    font-size: 0.75rem;
  }

  .header .grid-personal .personal span {
    text-transform: uppercase;
    color: var(--text-secondary);
  }

  .header .grid-personal .personal span.badge {
    color: #fff;
    display: table;
    padding: 4px 5px 2px;
    margin: -4px 0 1px 0;
  }

  .header .grid-personal .personal .lang {
    display: inline-flex;
    margin-right: 0.4em;
    column-gap: 0.2em;
    align-items: center;
  }

  .header .social-icon {
    display: flex;
    flex-direction: row;
    gap: 0.3em;
  }

  /* Printer Icon Styles */
  #printer .Vector139,
  #printer .Vector138,
  #printer .Vector140 {
    stroke: black;
  }

  .dark-mode #printer .Vector139,
  .dark-mode #printer .Vector138,
  .dark-mode #printer .Vector140 {
    stroke: white !important;
  }
</style>
